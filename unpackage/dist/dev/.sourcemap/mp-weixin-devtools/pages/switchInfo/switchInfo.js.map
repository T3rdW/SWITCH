{"version":3,"names":["_sfc_main","data","switchData","switchImages","onLoad","options","common_vendor","index","__f__","$on","handleSwitchData","id","loadSwitchData","onUnload","$off","methods","handleImageError","$set","Array","isArray","images","filter","img","fileID","_this","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","res","wrap","_callee$","_context","prev","next","showLoading","title","er","callFunction","name","action","sent","result","code","showToast","msg","icon","t0","hideLoading","finish","stop","getPriceText","price","concat","getForceText","force","toString","toLowerCase","includes","getDistanceText","distance","wx","createPage","MiniProgramPage"],"sources":["switchInfo.vue","cGFnZXMvc3dpdGNoSW5mby9zd2l0Y2hJbmZvLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<!-- 图片轮播 -->\n\t\t<swiper class=\"swiper\" circular :indicator-dots=\"true\" :autoplay=\"true\" :interval=\"3000\" :duration=\"1000\">\n\t\t\t<swiper-item v-for=\"(image, index) in switchImages\" :key=\"index\" class=\"swiper-item\">\n\t\t\t\t<image\n\t\t\t\t\t:src=\"image.fileID || '/static/default_switch.webp'\"\n\t\t\t\t\tmode=\"aspectFit\"\n\t\t\t\t\tclass=\"switch-image\"\n\t\t\t\t\t@error=\"handleImageError(index)\"\n\t\t\t\t/>\n\t\t\t</swiper-item>\n\t\t\t<!-- 无图片时显示默认图片 -->\n\t\t\t<swiper-item v-if=\"!switchImages.length\" class=\"swiper-item\">\n\t\t\t\t<image src=\"/static/default_switch.webp\" mode=\"aspectFit\" class=\"switch-image\" />\n\t\t\t</swiper-item>\n\t\t</swiper>\n\n\t\t<!-- 轴体信息列表 -->\n\t\t<uni-list class=\"info-list\">\n\t\t\t<!-- 基本信息 -->\n\t\t\t<uni-list-item title=\"轴体名称\" :right-text=\"switchData.name || '暂无'\" />\n\t\t\t<uni-list-item title=\"代工厂\" :right-text=\"switchData.manufacturer || '暂无'\" />\n\t\t\t<uni-list-item title=\"轴体分类\" :right-text=\"switchData.category || '暂无'\" />\n\t\t\t<uni-list-item title=\"上市时间\" :right-text=\"switchData.release_date || '暂无'\" />\n\t\t\t<uni-list-item title=\"价格\" :right-text=\"getPriceText(switchData.price)\" />\n\n\t\t\t<!-- 规格参数 -->\n\t\t\t<uni-list-item title=\"轴心材质\" :right-text=\"switchData.stem_material || '暂无'\" />\n\t\t\t<uni-list-item title=\"上盖材质\" :right-text=\"switchData.top_housing_material || '暂无'\" />\n\t\t\t<uni-list-item title=\"底壳材质\" :right-text=\"switchData.bottom_housing_material || '暂无'\" />\n\t\t\t<uni-list-item title=\"触发压力\" :right-text=\"getForceText(switchData.actuation_force)\" />\n\t\t\t<uni-list-item title=\"触发行程\" :right-text=\"getDistanceText(switchData.actuation_distance)\" />\n\t\t\t<uni-list-item title=\"触底压力\" :right-text=\"getForceText(switchData.bottom_force)\" />\n\t\t\t<uni-list-item title=\"总行程\" :right-text=\"getDistanceText(switchData.total_travel)\" />\n\n\t\t\t<!-- 其他信息 -->\n\t\t\t<uni-list-item title=\"更新时间\" :right-text=\"formatTime(switchData.update_time)\" />\n\t\t</uni-list>\n\t</view>\n</template>\n\n<script>\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tswitchData: {}, // 轴体数据\n\t\t\t\tswitchImages: [], // 轴体图片数组\n\t\t\t}\n\t\t},\n\n\t\tonLoad(options) {\n\t\t\tconsole.log('页面参数:', options)\n\t\t\t// 监听数据传递事件\n\t\t\tuni.$on('switchData', this.handleSwitchData)\n\t\t\tif (options.id) {\n\t\t\t\tthis.loadSwitchData(options.id)\n\t\t\t}\n\t\t},\n\n\t\tonUnload() {\n\t\t\t// 页面卸载时移除事件监听\n\t\t\tuni.$off('switchData', this.handleSwitchData)\n\t\t},\n\n\t\tmethods: {\n\t\t\t// 处理图片加载错误\n\t\t\thandleImageError(index) {\n\t\t\t\tconsole.log('图片加载失败:', index)\n\t\t\t\t// 将错误图片替换为默认图片\n\t\t\t\tif (this.switchImages[index]) {\n\t\t\t\t\tthis.$set(this.switchImages[index], 'fileID', '/static/default_switch.webp')\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 处理传递来的轴体数据\n\t\t\thandleSwitchData(data) {\n\t\t\t\tconsole.log('接收到轴体数据:', data)\n\t\t\t\tthis.switchData = data\n\t\t\t\t// 处理图片数组，只保留有效的 fileID\n\t\t\t\tthis.switchImages = Array.isArray(data.images) ? data.images.filter(img => img && img.fileID) : []\n\t\t\t\tconsole.log('处理后的图片数组:', this.switchImages)\n\t\t\t},\n\n\t\t\t// 加载轴体数据\n\t\t\tasync loadSwitchData(id) {\n\t\t\t\ttry {\n\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\ttitle: '加载中...'\n\t\t\t\t\t})\n\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'switchApi',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'getSwitchById',\n\t\t\t\t\t\t\tid: id\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tconsole.log('获取轴体数据结果:', res)\n\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\tthis.switchData = res.result.data\n\t\t\t\t\t\t// 处理图片数组，只保留有效的 fileID\n\t\t\t\t\t\tthis.switchImages = Array.isArray(this.switchData.images) ?\n\t\t\t\t\t\t\tthis.switchData.images.filter(img => img && img.fileID) : []\n\t\t\t\t\t\tconsole.log('加载后的图片数组:', this.switchImages)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: res.result.msg,\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('加载轴体数据失败:', e)\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '加载失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t} finally {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 格式化价格\n\t\t\tgetPriceText(price) {\n\t\t\t\treturn price ? `¥${price}` : '暂无报价'\n\t\t\t},\n\n\t\t\t// 格式化力度 gf\n\t\t\tgetForceText(force) {\n\t\t\t\tif (!force) return '暂无数据'\n\t\t\t\t// 如果已经包含 'gf' 就直接返回，否则添加 'gf'\n\t\t\t\treturn force.toString().toLowerCase().includes('gf') ? force : `${force}gf`\n\t\t\t},\n\n\t\t\t// 格式化距离 mm\n\t\t\tgetDistanceText(distance) {\n\t\t\t\tif (!distance) return '暂无数据'\n\t\t\t\treturn distance.toString().toLowerCase().includes('mm') ? distance : `${distance}mm`\n\t\t\t}\n\t\t}\n\t}\n</script>\n","import MiniProgramPage from 'K:/HBuilderProjects/SWITCH/pages/switchInfo/switchInfo.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}