{"version":3,"file":"switchInfo.js","sources":["pages/switchInfo/switchInfo.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc3dpdGNoSW5mby9zd2l0Y2hJbmZvLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<!-- 图片轮播 -->\n\t\t<swiper class=\"swiper\" circular :indicator-dots=\"true\" :autoplay=\"true\" :interval=\"3000\" :duration=\"1000\">\n\t\t\t<swiper-item v-for=\"(image, index) in switchImages\" :key=\"index\" class=\"swiper-item\">\n\t\t\t\t<image\n\t\t\t\t\t:src=\"image.fileID || '/static/default_switch.webp'\"\n\t\t\t\t\tmode=\"aspectFit\"\n\t\t\t\t\tclass=\"switch-image\"\n\t\t\t\t\t@error=\"handleImageError(index)\"\n\t\t\t\t/>\n\t\t\t</swiper-item>\n\t\t\t<!-- 无图片时显示默认图片 -->\n\t\t\t<swiper-item v-if=\"!switchImages.length\" class=\"swiper-item\">\n\t\t\t\t<image src=\"/static/default_switch.webp\" mode=\"aspectFit\" class=\"switch-image\" />\n\t\t\t</swiper-item>\n\t\t</swiper>\n\n\t\t<!-- 轴体信息列表 -->\n\t\t<uni-list class=\"info-list\">\n\t\t\t<!-- 基本信息 -->\n\t\t\t<uni-list-item title=\"轴体名称\" :right-text=\"switchData.switch_name || '暂无'\" />\n\t\t\t<uni-list-item title=\"代工厂\" :right-text=\"switchData.manufacturer || '暂无'\" />\n\t\t\t<uni-list-item title=\"轴体分类\" :right-text=\"switchData.switch_type || '暂无'\" />\n\t\t\t<uni-list-item title=\"上市时间\" :right-text=\"switchData.release_date || '暂无'\" />\n\t\t\t<uni-list-item title=\"价格\" :right-text=\"getPriceText(switchData.price)\" />\n\n\t\t\t<!-- 规格参数 -->\n\t\t\t<uni-list-item title=\"轴心材质\" :right-text=\"switchData.stem_material || '暂无'\" />\n\t\t\t<uni-list-item title=\"上盖材质\" :right-text=\"switchData.top_housing_material || '暂无'\" />\n\t\t\t<uni-list-item title=\"底壳材质\" :right-text=\"switchData.bottom_housing_material || '暂无'\" />\n\t\t\t<uni-list-item title=\"触发压力\" :right-text=\"getForceText(switchData.actuation_force)\" />\n\t\t\t<uni-list-item title=\"触发行程\" :right-text=\"getDistanceText(switchData.actuation_travel)\" />\n\t\t\t<uni-list-item title=\"触底压力\" :right-text=\"getForceText(switchData.bottom_force)\" />\n\t\t\t<uni-list-item title=\"触底行程\" :right-text=\"getDistanceText(switchData.bottom_out_travel)\" />\n\t\t\t<uni-list-item title=\"总行程\" :right-text=\"getDistanceText(switchData.total_travel)\" />\n\t\t\t<uni-list-item title=\"弹簧长度\" :right-text=\"switchData.spring_length || '暂无'\" />\n\t\t\t<uni-list-item title=\"出厂润滑\" :right-text=\"switchData.factory_lube ? '是' : '否'\" />\n\t\t\t<uni-list-item title=\"寿命\" :right-text=\"switchData.lifespan || '暂无'\" />\n\n\t\t\t<!-- 其他信息 -->\n\t\t\t<uni-list-item title=\"更新时间\" :right-text=\"formatTime(switchData.update_time)\" />\n\t\t\t<uni-list-item title=\"数据来源\" :right-text=\"switchData.data_source || '暂无'\" />\n\t\t\t<related-keyboards-item\n\t\t\t\t:keyboards=\"getRelatedKeyboards(switchData.related_keyboards)\"\n\t\t\t/>\n\t\t\t<uni-list-item title=\"停产\" :right-text=\"switchData.discontinued ? '是' : '否'\" />\n\t\t\t<uni-list-item title=\"备注\" :right-text=\"switchData.remark || '暂无'\" />\n\t\t\t<uni-list-item title=\"审核状态\" :right-text=\"switchData.audit_status || '暂无'\" />\n\t\t</uni-list>\n\t</view>\n</template>\n\n<script>\n\timport RelatedKeyboardsItem from '@/components/related-keyboards-item.vue'\n\n\texport default {\n\t\tcomponents: {\n\t\t\tRelatedKeyboardsItem\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tswitchData: {}, // 轴体数据\n\t\t\t\tswitchImages: [], // 轴体图片数组\n\t\t\t}\n\t\t},\n\n\t\tonLoad(options) {\n\t\t\tconsole.log('页面参数:', options)\n\t\t\t// 监听数据传递事件\n\t\t\tuni.$on('switchData', this.handleSwitchData)\n\t\t\tif (options.id) {\n\t\t\t\tthis.loadSwitchData(options.id)\n\t\t\t}\n\t\t},\n\n\t\tonUnload() {\n\t\t\t// 页面卸载时移除事件监听\n\t\t\tuni.$off('switchData', this.handleSwitchData)\n\t\t},\n\n\t\tmethods: {\n\t\t\t// 处理图片加载错误\n\t\t\thandleImageError(index) {\n\t\t\t\tconsole.log('图片加载失败:', index)\n\t\t\t\t// 将错误图片替换为默认图片\n\t\t\t\tif (this.switchImages[index]) {\n\t\t\t\t\tthis.$set(this.switchImages[index], 'fileID', '/static/default_switch.webp')\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 处理传递来的轴体数据\n\t\t\thandleSwitchData(data) {\n\t\t\t\tconsole.log('接收到轴体数据:', data)\n\t\t\t\tthis.switchData = data\n\t\t\t\t// 处理图片数组，只保留有效的 fileID\n\t\t\t\tthis.switchImages = Array.isArray(data.images) ? data.images.filter(img => img && img.fileID) : []\n\t\t\t\tconsole.log('处理后的图片数组:', this.switchImages)\n\t\t\t},\n\n\t\t\t// 加载轴体数据\n\t\t\tasync loadSwitchData(id) {\n\t\t\t\ttry {\n\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\ttitle: '加载中...'\n\t\t\t\t\t})\n\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'switchApi',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'getSwitchById',\n\t\t\t\t\t\t\tid: id\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tconsole.log('获取轴体数据结果:', res)\n\n\t\t\t\t\tif (res.result.errCode === 0) {\n\t\t\t\t\t\tthis.switchData = res.result.data\n\t\t\t\t\t\t// 处理图片数组，只保留有效的 fileID\n\t\t\t\t\t\tthis.switchImages = Array.isArray(this.switchData.images) ?\n\t\t\t\t\t\t\tthis.switchData.images.filter(img => img && img.fileID) : []\n\t\t\t\t\t\tconsole.log('加载后的图片数组:', this.switchImages)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: res.result.errMsg || '加载失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('加载轴体数据失败:', e)\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '加载失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t} finally {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 格式化价格\n\t\t\tgetPriceText(price) {\n\t\t\t\treturn price ? `¥${price}` : '暂无报价'\n\t\t\t},\n\n\t\t\t// 格式化力度\n\t\t\tgetForceText(force) {\n\t\t\t\tif (!force) return '暂无数据'\n\t\t\t\t// 如果已经包含 'gf' 就直接返回，否则添加 'gf'\n\t\t\t\treturn force.toString().toLowerCase().includes('gf') ? force : `${force}gf`\n\t\t\t},\n\n\t\t\t// 格式化距离 mm\n\t\t\tgetDistanceText(distance) {\n\t\t\t\t// 如果值为空，返回暂无数据\n\t\t\t\tif (!distance) return '暂无数据'\n\n\t\t\t\tconst distanceStr = distance.toString().toLowerCase()\n\n\t\t\t\t// 如果已经包含 mm，直接返回\n\t\t\t\tif (distanceStr.includes('mm')) {\n\t\t\t\t\treturn distance\n\t\t\t\t}\n\n\t\t\t\t// 如果不包含数字，直接返回原值\n\t\t\t\tif (!/\\d/.test(distanceStr)) {\n\t\t\t\t\treturn distance\n\t\t\t\t}\n\n\t\t\t\t// 包含数字但不包含 mm，添加 mm\n\t\t\t\treturn `${distance}mm`\n\t\t\t},\n\n\t\t\t// 格式化时间\n\t\t\tformatTime(time) {\n\t\t\t\tif (!time) return '暂无数据'\n\t\t\t\ttry {\n\t\t\t\t\tconst date = new Date(time)\n\t\t\t\t\tconst year = date.getFullYear()\n\t\t\t\t\tconst month = String(date.getMonth() + 1).padStart(2, '0')\n\t\t\t\t\tconst day = String(date.getDate()).padStart(2, '0')\n\t\t\t\t\tconst hours = String(date.getHours()).padStart(2, '0')\n\t\t\t\t\tconst minutes = String(date.getMinutes()).padStart(2, '0')\n\t\t\t\t\tconst seconds = String(date.getSeconds()).padStart(2, '0')\n\t\t\t\t\treturn `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('时间格式化失败:', e)\n\t\t\t\t\treturn time\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 处理相关键盘字段的数据\n\t\t\tgetRelatedKeyboards(keyboards) {\n\t\t\t\tif (!keyboards || !Array.isArray(keyboards) || keyboards.length === 0) {\n\t\t\t\t\treturn '--'\n\t\t\t\t}\n\t\t\t\treturn keyboards.join(', ')\n\t\t\t},\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\t.container {\n\t\tmin-height: 100vh;\n\t\tbackground-color: #f5f5f5;\n\t}\n\n\t.swiper {\n\t\theight: 300px;\n\t\tbackground-color: #fff;\n\n\t\t.swiper-item {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: center;\n\t\t\talign-items: center;\n\t\t\tbackground-color: #fff;\n\n\t\t\t.switch-image {\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tobject-fit: contain;\n\t\t\t}\n\t\t}\n\t}\n\n\t.info-list {\n\t\tmargin-top: 10px;\n\n\t\t:deep(.uni-list-item) {\n\t\t\t.uni-list-item__container {\n\t\t\t\tflex: 1;\n\t\t\t\tflex-direction: row;\n\t\t\t\tpadding: 12px 15px;\n\t\t\t}\n\n\t\t\t.uni-list-item__content {\n\t\t\t\tflex: none;\n\t\t\t\twidth: 100px;\n\t\t\t}\n\n\t\t\t.uni-list-item__content-title {\n\t\t\t\tfont-size: 14px;\n\t\t\t\tcolor: #666;\n\t\t\t\twhite-space: nowrap;\n\t\t\t}\n\n\t\t\t.uni-list-item__extra {\n\t\t\t\tflex: 1;\n\t\t\t\toverflow: visible;\n\t\t\t\talign-items: flex-end;\n\t\t\t}\n\n\t\t\t.uni-list-item__extra-text {\n\t\t\t\tfont-size: 14px;\n\t\t\t\tcolor: #333;\n\t\t\t\ttext-align: right;\n\t\t\t\twhite-space: normal;\n\t\t\t\tword-break: break-all;\n\t\t\t\tline-height: 1.4;\n\t\t\t\twidth: 100%;\n\t\t\t\tpadding-left: 15px;\n\t\t\t\tpadding-right: 15px;\n\t\t\t}\n\t\t}\n\t}\n</style>\n","import MiniProgramPage from 'K:/HBuilderProjects/SWITCH/pages/switchInfo/switchInfo.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":";;;AAsDC,6BAA6B,MAAW;AAExC,MAAK,YAAU;AAAA,EACd,YAAY;AAAA,IACX;AAAA,EACA;AAAA,EACD,OAAO;AACN,WAAO;AAAA,MACN,YAAY,CAAE;AAAA;AAAA,MACd,cAAc,CAAE;AAAA;AAAA,IACjB;AAAA,EACA;AAAA,EAED,OAAO,SAAS;AACfA,kBAAAA,MAAA,MAAA,OAAA,yCAAY,SAAS,OAAO;AAE5BA,kBAAAA,MAAI,IAAI,cAAc,KAAK,gBAAgB;AAC3C,QAAI,QAAQ,IAAI;AACf,WAAK,eAAe,QAAQ,EAAE;AAAA,IAC/B;AAAA,EACA;AAAA,EAED,WAAW;AAEVA,kBAAAA,MAAI,KAAK,cAAc,KAAK,gBAAgB;AAAA,EAC5C;AAAA,EAED,SAAS;AAAA;AAAA,IAER,iBAAiB,OAAO;AACvBA,oBAAAA,MAAA,MAAA,OAAA,yCAAY,WAAW,KAAK;AAE5B,UAAI,KAAK,aAAa,KAAK,GAAG;AAC7B,aAAK,KAAK,KAAK,aAAa,KAAK,GAAG,UAAU,6BAA6B;AAAA,MAC5E;AAAA,IACA;AAAA;AAAA,IAGD,iBAAiB,MAAM;AACtBA,oBAAAA,MAAA,MAAA,OAAA,yCAAY,YAAY,IAAI;AAC5B,WAAK,aAAa;AAElB,WAAK,eAAe,MAAM,QAAQ,KAAK,MAAM,IAAI,KAAK,OAAO,OAAO,SAAO,OAAO,IAAI,MAAM,IAAI,CAAC;AACjGA,oBAAA,MAAA,MAAA,OAAA,yCAAY,aAAa,KAAK,YAAY;AAAA,IAC1C;AAAA;AAAA,IAGD,MAAM,eAAe,IAAI;AACxB,UAAI;AACHA,sBAAAA,MAAI,YAAY;AAAA,UACf,OAAO;AAAA,SACP;AAED,cAAM,MAAM,MAAMC,cAAQ,GAAC,aAAa;AAAA,UACvC,MAAM;AAAA,UACN,MAAM;AAAA,YACL,QAAQ;AAAA,YACR;AAAA,UACD;AAAA,SACA;AAEDD,sBAAAA,6DAAY,aAAa,GAAG;AAE5B,YAAI,IAAI,OAAO,YAAY,GAAG;AAC7B,eAAK,aAAa,IAAI,OAAO;AAE7B,eAAK,eAAe,MAAM,QAAQ,KAAK,WAAW,MAAM,IACvD,KAAK,WAAW,OAAO,OAAO,SAAO,OAAO,IAAI,MAAM,IAAI,CAAC;AAC5DA,qFAAY,aAAa,KAAK,YAAY;AAAA,eACpC;AACNA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO,IAAI,OAAO,UAAU;AAAA,YAC5B,MAAM;AAAA,WACN;AAAA,QACF;AAAA,MACD,SAAS,GAAG;AACXA,sBAAAA,MAAc,MAAA,SAAA,0CAAA,aAAa,CAAC;AAC5BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,SACN;AAAA,MACF,UAAU;AACTA,sBAAAA,MAAI,YAAY;AAAA,MACjB;AAAA,IACA;AAAA;AAAA,IAGD,aAAa,OAAO;AACnB,aAAO,QAAQ,IAAI,KAAK,KAAK;AAAA,IAC7B;AAAA;AAAA,IAGD,aAAa,OAAO;AACnB,UAAI,CAAC;AAAO,eAAO;AAEnB,aAAO,MAAM,WAAW,cAAc,SAAS,IAAI,IAAI,QAAQ,GAAG,KAAK;AAAA,IACvE;AAAA;AAAA,IAGD,gBAAgB,UAAU;AAEzB,UAAI,CAAC;AAAU,eAAO;AAEtB,YAAM,cAAc,SAAS,SAAQ,EAAG,YAAY;AAGpD,UAAI,YAAY,SAAS,IAAI,GAAG;AAC/B,eAAO;AAAA,MACR;AAGA,UAAI,CAAC,KAAK,KAAK,WAAW,GAAG;AAC5B,eAAO;AAAA,MACR;AAGA,aAAO,GAAG,QAAQ;AAAA,IAClB;AAAA;AAAA,IAGD,WAAW,MAAM;AAChB,UAAI,CAAC;AAAM,eAAO;AAClB,UAAI;AACH,cAAM,OAAO,IAAI,KAAK,IAAI;AAC1B,cAAM,OAAO,KAAK,YAAY;AAC9B,cAAM,QAAQ,OAAO,KAAK,SAAQ,IAAK,CAAC,EAAE,SAAS,GAAG,GAAG;AACzD,cAAM,MAAM,OAAO,KAAK,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AAClD,cAAM,QAAQ,OAAO,KAAK,SAAU,CAAA,EAAE,SAAS,GAAG,GAAG;AACrD,cAAM,UAAU,OAAO,KAAK,WAAY,CAAA,EAAE,SAAS,GAAG,GAAG;AACzD,cAAM,UAAU,OAAO,KAAK,WAAY,CAAA,EAAE,SAAS,GAAG,GAAG;AACzD,eAAO,GAAG,IAAI,IAAI,KAAK,IAAI,GAAG,IAAI,KAAK,IAAI,OAAO,IAAI,OAAO;AAAA,MAC9D,SAAS,GAAG;AACXA,sBAAAA,MAAc,MAAA,SAAA,0CAAA,YAAY,CAAC;AAC3B,eAAO;AAAA,MACR;AAAA,IACA;AAAA;AAAA,IAGD,oBAAoB,WAAW;AAC9B,UAAI,CAAC,aAAa,CAAC,MAAM,QAAQ,SAAS,KAAK,UAAU,WAAW,GAAG;AACtE,eAAO;AAAA,MACR;AACA,aAAO,UAAU,KAAK,IAAI;AAAA,IAC1B;AAAA,EACF;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtMD,GAAG,WAAW,eAAe;"}