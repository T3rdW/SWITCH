{"version":3,"file":"switchInfo.js","sources":["pages/switchInfo/switchInfo.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc3dpdGNoSW5mby9zd2l0Y2hJbmZvLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<!-- 图片管理遮罩层 -->\n\t\t<view class=\"edit-overlay\" v-if=\"isEditing\">\n\t\t\t<view class=\"edit-container\">\n\t\t\t\t<view class=\"edit-header\">\n\t\t\t\t\t<text class=\"edit-title\">图片管理 {{ switchImages.length ? `(${currentImageIndex + 1}/${switchImages.length})` : '' }}</text>\n\t\t\t\t\t<text class=\"close-btn\" @tap=\"isEditing = false\">×</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"edit-image-container\">\n\t\t\t\t\t<view class=\"type-selector\" v-if=\"currentImage.fileID\">\n\t\t\t\t\t\t<picker\n\t\t\t\t\t\t\tmode=\"selector\"\n\t\t\t\t\t\t\t:range=\"imageTypeOptions\"\n\t\t\t\t\t\t\trange-key=\"text\"\n\t\t\t\t\t\t\t:value=\"getTypeIndex(currentImage.type)\"\n\t\t\t\t\t\t\t@change=\"handleTypeChange\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<view class=\"picker-content\">\n\t\t\t\t\t\t\t\t<text>{{ currentImage.type ? getImageTypeText(currentImage.type) : '选择类型' }}</text>\n\t\t\t\t\t\t\t\t<text class=\"picker-arrow\">▼</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</picker>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"nav-btn prev\" @tap=\"handlePrevImage\" v-if=\"switchImages.length > 1\">\n\t\t\t\t\t\t<text class=\"nav-icon\">‹</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<image\n\t\t\t\t\t\tv-if=\"switchImages.length\"\n\t\t\t\t\t\t:src=\"currentImage.fileID || '/static/default_switch.webp'\"\n\t\t\t\t\t\tmode=\"aspectFit\"\n\t\t\t\t\t\tclass=\"edit-image\"\n\t\t\t\t\t/>\n\t\t\t\t\t<view v-else class=\"empty-image\">\n\t\t\t\t\t\t<text>暂无图片</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"nav-btn next\" @tap=\"handleNextImage\" v-if=\"switchImages.length > 1\">\n\t\t\t\t\t\t<text class=\"nav-icon\">›</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"edit-buttons\">\n\t\t\t\t\t<view class=\"btn-row\">\n\t\t\t\t\t\t<button class=\"btn add\" @tap=\"handleAddImage\">添加图片</button>\n\t\t\t\t\t\t<button class=\"btn\" @tap=\"handleEditConfirm\" v-if=\"switchImages.length\">更换图片</button>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"btn-row\">\n\t\t\t\t\t\t<button class=\"btn delete\" @tap=\"handleDeleteImage\" v-if=\"switchImages.length\">删除图片</button>\n\t\t\t\t\t\t<button class=\"btn cancel\" @tap=\"isEditing = false\">取消</button>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<!-- 图片指示器 -->\n\t\t\t\t<view class=\"image-indicators\" v-if=\"switchImages.length > 1\">\n\t\t\t\t\t<view\n\t\t\t\t\t\tv-for=\"(_, index) in switchImages\"\n\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\t:class=\"['indicator-dot', { active: index === currentImageIndex }]\"\n\t\t\t\t\t\t@tap=\"handleIndicatorTap(index)\"\n\t\t\t\t\t></view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 图片管理触发区域 -->\n\t\t<view class=\"image-manage-trigger\" @tap=\"handleTriggerTap\">\n\t\t</view>\n\n\t\t<!-- 图片轮播 -->\n\t\t<swiper class=\"swiper\" circular :indicator-dots=\"true\" :autoplay=\"!isEditing\" :interval=\"3000\" :duration=\"1000\" @change=\"handleSwiperChange\">\n\t\t\t<swiper-item v-for=\"(image, index) in switchImages\" :key=\"index\" class=\"swiper-item\">\n\t\t\t\t<view class=\"image-wrapper\">\n\t\t\t\t\t<image\n\t\t\t\t\t\t:src=\"image.fileID ? image.fileID : '/static/default_switch.webp'\"\n\t\t\t\t\t\tmode=\"aspectFit\"\n\t\t\t\t\t\tclass=\"switch-image\"\n\t\t\t\t\t\t@error=\"handleImageError(index)\"\n\t\t\t\t\t\t@load=\"handleImageLoad(index)\"\n\t\t\t\t\t/>\n\t\t\t\t\t<view class=\"image-type-tag\" v-if=\"image.type\">\n\t\t\t\t\t\t{{ getImageTypeText(image.type) }}\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</swiper-item>\n\t\t</swiper>\n\n\t\t<!-- 轴体信息列表 -->\n\t\t<uni-list class=\"info-list\">\n\t\t\t<!-- 基本信息 -->\n\t\t\t<uni-list-item title=\"轴体名称\" :right-text=\"switchData.switch_name || '暂无'\" />\n\t\t\t<uni-list-item title=\"代工厂\" :right-text=\"switchData.manufacturer || '暂无'\" />\n\t\t\t<uni-list-item title=\"轴体分类\" :right-text=\"switchData.switch_type || '暂无'\" />\n\t\t\t<uni-list-item title=\"上市时间\" :right-text=\"switchData.release_date || '暂无'\" />\n\t\t\t<uni-list-item title=\"价格\" :right-text=\"getPriceText(switchData.price)\" />\n\n\t\t\t<!-- 规格参数 -->\n\t\t\t<uni-list-item title=\"轴心材质\" :right-text=\"switchData.stem_material || '暂无'\" />\n\t\t\t<uni-list-item title=\"上盖材质\" :right-text=\"switchData.top_housing_material || '暂无'\" />\n\t\t\t<uni-list-item title=\"底壳材质\" :right-text=\"switchData.bottom_housing_material || '暂无'\" />\n\t\t\t<uni-list-item title=\"触发压力\" :right-text=\"getForceText(switchData.actuation_force)\" />\n\t\t\t<uni-list-item title=\"触发行程\" :right-text=\"getDistanceText(switchData.actuation_travel)\" />\n\t\t\t<uni-list-item title=\"触底压力\" :right-text=\"getForceText(switchData.bottom_force)\" />\n\t\t\t<uni-list-item title=\"触底行程\" :right-text=\"getDistanceText(switchData.bottom_out_travel)\" />\n\t\t\t<uni-list-item title=\"总行程\" :right-text=\"getDistanceText(switchData.total_travel)\" />\n\t\t\t<uni-list-item title=\"弹簧长度\" :right-text=\"switchData.spring_length || '暂无'\" />\n\t\t\t<uni-list-item title=\"出厂润滑\" :right-text=\"switchData.factory_lube ? '是' : '否'\" />\n\t\t\t<uni-list-item title=\"寿命\" :right-text=\"switchData.lifespan || '暂无'\" />\n\n\t\t\t<!-- 其他信息 -->\n\t\t\t<uni-list-item title=\"更新时间\" :right-text=\"formatTime(switchData.update_time)\" />\n\t\t\t<uni-list-item title=\"数据来源\" :right-text=\"switchData.data_source || '暂无'\" />\n\t\t\t<related-keyboards-item\n\t\t\t\t:keyboards=\"getRelatedKeyboards(switchData.related_keyboards)\"\n\t\t\t/>\n\t\t\t<uni-list-item title=\"停产\" :right-text=\"switchData.discontinued ? '是' : '否'\" />\n\t\t\t<remark-item :remark=\"switchData.remark || '暂无'\" />\n\t\t\t<uni-list-item title=\"审核状态\" :right-text=\"switchData.audit_status || '暂无'\" />\n\t\t</uni-list>\n\t</view>\n</template>\n\n<script>\n\timport RelatedKeyboardsItem from '@/components/related-keyboards-item.vue'\n\timport RemarkItem from '@/components/remark-item.vue'\n\n\texport default {\n\t\tcomponents: {\n\t\t\tRelatedKeyboardsItem,\n\t\t\tRemarkItem\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tswitchData: {}, // 轴体数据\n\t\t\t\tswitchImages: [], // 轴体图片数组\n\t\t\t\ttriggerCount: 0, // 触发计数器\n\t\t\t\tcurrentImageIndex: 0, // 当前显示的图片索引\n\t\t\t\tisEditing: false, // 是否正在编辑图片\n\t\t\t\tisLoading: false, // 是否正在加载数据\n\t\t\t\timageTypeOptions: [\n\t\t\t\t\t{ text: '详情图', value: 'detail' },\n\t\t\t\t\t{ text: '上盖图', value: 'top' },\n\t\t\t\t\t{ text: '轴心图', value: 'stem' },\n\t\t\t\t\t{ text: '弹簧图', value: 'spring' },\n\t\t\t\t\t{ text: '底壳图', value: 'bottom' },\n\t\t\t\t\t{ text: '侧图', value: 'side' },\n\t\t\t\t\t{ text: '外壳图', value: 'housing' },\n\t\t\t\t\t{ text: '其他视图', value: 'other' }\n\t\t\t\t],\n\t\t\t\tMAX_WIDTH: 1280,\n\t\t\t\tMAX_HEIGHT: 1280,\n\t\t\t\tQUALITY: 0.8\n\t\t\t}\n\t\t},\n\n\t\tcomputed: {\n\t\t\tcurrentImage() {\n\t\t\t\treturn this.switchImages[this.currentImageIndex] || {};\n\t\t\t}\n\t\t},\n\n\t\tonLoad(options) {\n\t\t\tconsole.log('详情页面加载, 参数:', options)\n\t\t\t// 监听数据传递事件\n\t\t\tuni.$on('switchData', this.handleSwitchData)\n\n\t\t\t// 如果没有立即收到数据，可以使用 ID 加载\n\t\t\tif (options.id) {\n\t\t\t\tconsole.log('准备使用 ID 加载数据:', options.id)\n\t\t\t\t// 给事件监听一些时间来接收数据\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (!this.switchData._id) {\n\t\t\t\t\t\tconsole.log('未收到数据，从服务器加载')\n\t\t\t\t\t\tthis.loadSwitchDataById(options.id)\n\t\t\t\t\t}\n\t\t\t\t}, 200)\n\t\t\t}\n\t\t},\n\n\t\tonUnload() {\n\t\t\t// 页面卸载时移除事件监听\n\t\t\tuni.$off('switchData', this.handleSwitchData)\n\t\t},\n\n\t\tmethods: {\n\t\t\t// 处理图片加载成功\n\t\t\thandleImageLoad(index) {\n\t\t\t\tconsole.log('图片加载成功:', index, {\n\t\t\t\t\tfileID: this.switchImages[index].fileID,\n\t\t\t\t\ttype: this.switchImages[index].type\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t// 处理传递来的轴体数据\n\t\t\thandleSwitchData(data) {\n\t\t\t\tconsole.log('接收到轴体数据:', data)\n\t\t\t\t// 打印完整的图片数组信息\n\t\t\t\tconsole.log('原始 preview_images:', data.preview_images)\n\n\t\t\t\t// 如果已经有相同的数据，不需要重新设置\n\t\t\t\tif (this.switchData._id === data._id) {\n\t\t\t\t\tconsole.log('已有相同数据，跳过更新');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.switchData = data\n\t\t\t\t// 处理图片数组，只保留有效的 fileID\n\t\t\t\tif (Array.isArray(data.preview_images)) {\n\t\t\t\t\t// 如果图片数据无效，使用默认图片\n\t\t\t\t\tthis.switchImages = data.preview_images.map(img => {\n\t\t\t\t\t\tif (!img || !img.fileID) {\n\t\t\t\t\t\t\tconsole.log('发现无效图片数据，使用默认图片:', img);\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tfileID: '/static/default_switch.webp',\n\t\t\t\t\t\t\t\ttype: 'detail',\n\t\t\t\t\t\t\t\tfileName: 'default_switch.webp',\n\t\t\t\t\t\t\t\tuploadTime: '',\n\t\t\t\t\t\t\t\tupdateTime: ''\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn img;\n\t\t\t\t\t});\n\t\t\t\t\tconsole.log('处理后的图片数组:', this.switchImages);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('preview_images 不是数组:', data.preview_images);\n\t\t\t\t\t// 如果没有图片数组，使用默认图片\n\t\t\t\t\tthis.switchImages = [{\n\t\t\t\t\t\tfileID: '/static/default_switch.webp',\n\t\t\t\t\t\ttype: 'detail',\n\t\t\t\t\t\tfileName: 'default_switch.webp',\n\t\t\t\t\t\tuploadTime: '',\n\t\t\t\t\t\tupdateTime: ''\n\t\t\t\t\t}];\n\t\t\t\t}\n\n\t\t\t\t// 更新页面标题为轴体名称\n\t\t\t\tif (data.switch_name) {\n\t\t\t\t\twx.setNavigationBarTitle({\n\t\t\t\t\t\ttitle: data.switch_name\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 格式化价格\n\t\t\tgetPriceText(price) {\n\t\t\t\treturn price ? `¥${price}` : '暂无报价'\n\t\t\t},\n\n\t\t\t// 格式化力度\n\t\t\tgetForceText(force) {\n\t\t\t\tif (!force) return '暂无数据'\n\t\t\t\t// 如果已经包含 'gf' 就直接返回，否则添加 'gf'\n\t\t\t\treturn force.toString().toLowerCase().includes('gf') ? force : `${force}gf`\n\t\t\t},\n\n\t\t\t// 格式化距离 mm\n\t\t\tgetDistanceText(distance) {\n\t\t\t\t// 如果值为空，返回暂无数据\n\t\t\t\tif (!distance) return '暂无数据'\n\n\t\t\t\tconst distanceStr = distance.toString().toLowerCase()\n\n\t\t\t\t// 如果已经包含 mm，直接返回\n\t\t\t\tif (distanceStr.includes('mm')) {\n\t\t\t\t\treturn distance\n\t\t\t\t}\n\n\t\t\t\t// 如果不包含数字，直接返回原值\n\t\t\t\tif (!/\\d/.test(distanceStr)) {\n\t\t\t\t\treturn distance\n\t\t\t\t}\n\n\t\t\t\t// 包含数字但不包含 mm，添加 mm\n\t\t\t\treturn `${distance}mm`\n\t\t\t},\n\n\t\t\t// 获取北京时间的 ISO 格式字符串\n\t\t\tgetBeiJingISOString() {\n\t\t\t\tconst now = new Date();\n\t\t\t\t// 转换为北京时间\n\t\t\t\tconst beijingDate = new Date(now.getTime() + 8 * 60 * 60 * 1000);\n\t\t\t\treturn beijingDate.toISOString().slice(0, 19).replace('Z', '');\n\t\t\t},\n\n\t\t\t// 格式化时间\n\t\t\tformatTime(time) {\n\t\t\t\tif (!time) return '暂无数据'\n\t\t\t\ttry {\n\t\t\t\t\t// 如果时间已经是 ISO 格式，直接格式化显示\n\t\t\t\t\tif (time.includes('T')) {\n\t\t\t\t\t\treturn time.replace('T', ' ').slice(0, 19)\n\t\t\t\t\t}\n\t\t\t\t\t// 否则尝试转换为 ISO 格式\n\t\t\t\t\tconst date = new Date(time)\n\t\t\t\t\t// 转换为北京时间\n\t\t\t\t\tconst beijingDate = new Date(date.getTime() + 8 * 60 * 60 * 1000);\n\t\t\t\t\treturn beijingDate.toISOString().slice(0, 19).replace('Z', '')\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('时间格式化失败:', e)\n\t\t\t\t\treturn time\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 处理相关键盘字段的数据\n\t\t\tgetRelatedKeyboards(keyboards) {\n\t\t\t\tif (!keyboards || !Array.isArray(keyboards) || keyboards.length === 0) {\n\t\t\t\t\treturn '--'\n\t\t\t\t}\n\t\t\t\treturn keyboards.join(', ')\n\t\t\t},\n\n\t\t\t// 处理轮播图切换\n\t\t\thandleSwiperChange(e) {\n\t\t\t\tthis.currentImageIndex = e.detail.current\n\t\t\t},\n\n\t\t\t// 压缩图片\n\t\t\tasync compressImage(tempFilePath) {\n\t\t\t\ttry {\n\t\t\t\t\tconsole.log('开始压缩图片:', tempFilePath);\n\n\t\t\t\t\t// 检查图片格式\n\t\t\t\t\tconst ext = tempFilePath.split('.').pop().toLowerCase();\n\t\t\t\t\tconsole.log('图片格式:', ext);\n\n\t\t\t\t\t// 获取文件系统管理器\n\t\t\t\t\tconst fs = wx.getFileSystemManager();\n\n\t\t\t\t\t// 先获取图片信息\n\t\t\t\t\tconst imageInfo = await new Promise((resolve, reject) => {\n\t\t\t\t\t\twx.getImageInfo({\n\t\t\t\t\t\t\tsrc: tempFilePath,\n\t\t\t\t\t\t\tsuccess: resolve,\n\t\t\t\t\t\t\tfail: reject\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tconsole.log('原始图片信息:', imageInfo);\n\n\t\t\t\t\t// 获取原始图片大小\n\t\t\t\t\tconst originalFileInfo = await new Promise((resolve, reject) => {\n\t\t\t\t\t\tfs.getFileInfo({\n\t\t\t\t\t\t\tfilePath: tempFilePath,\n\t\t\t\t\t\t\tsuccess: resolve,\n\t\t\t\t\t\t\tfail: reject\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tconst originalSize = (originalFileInfo.size / 1024).toFixed(2);\n\t\t\t\t\tconsole.log(`原始图片大小: ${originalSize}KB, 尺寸: ${imageInfo.width}x${imageInfo.height}`);\n\n\t\t\t\t\t// 计算压缩后的尺寸\n\t\t\t\t\tlet targetWidth = imageInfo.width;\n\t\t\t\t\tlet targetHeight = imageInfo.height;\n\t\t\t\t\tconst maxSize = 1280; // 设置最大边长为1280px\n\t\t\t\t\tconst quality = 50; // 降低质量以减小文件大小\n\n\t\t\t\t\t// 等比例缩放\n\t\t\t\t\tif (targetWidth > targetHeight && targetWidth > maxSize) {\n\t\t\t\t\t\ttargetHeight = Math.round((targetHeight * maxSize) / targetWidth);\n\t\t\t\t\t\ttargetWidth = maxSize;\n\t\t\t\t\t} else if (targetHeight > targetWidth && targetHeight > maxSize) {\n\t\t\t\t\t\ttargetWidth = Math.round((targetWidth * maxSize) / targetHeight);\n\t\t\t\t\t\ttargetHeight = maxSize;\n\t\t\t\t\t}\n\n\t\t\t\t\tconsole.log('计算后的尺寸:', { width: targetWidth, height: targetHeight });\n\n\t\t\t\t\t// 使用微信小程序的压缩API\n\t\t\t\t\tconst compressedPath = await new Promise((resolve, reject) => {\n\t\t\t\t\t\twx.compressImage({\n\t\t\t\t\t\t\tsrc: tempFilePath,\n\t\t\t\t\t\t\tquality: quality,\n\t\t\t\t\t\t\tcompressedWidth: targetWidth,\n\t\t\t\t\t\t\tcompressHeight: targetHeight,\n\t\t\t\t\t\t\tsuccess: resolve,\n\t\t\t\t\t\t\tfail: reject\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\t// 获取压缩后的图片信息\n\t\t\t\t\tconst compressedInfo = await new Promise((resolve, reject) => {\n\t\t\t\t\t\twx.getImageInfo({\n\t\t\t\t\t\t\tsrc: compressedPath.tempFilePath,\n\t\t\t\t\t\t\tsuccess: resolve,\n\t\t\t\t\t\t\tfail: reject\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\t// 获取压缩后的文件大小\n\t\t\t\t\tconst finalFileInfo = await new Promise((resolve, reject) => {\n\t\t\t\t\t\tfs.getFileInfo({\n\t\t\t\t\t\t\tfilePath: compressedPath.tempFilePath,\n\t\t\t\t\t\t\tsuccess: resolve,\n\t\t\t\t\t\t\tfail: reject\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tconst compressedSize = (finalFileInfo.size / 1024).toFixed(2);\n\t\t\t\t\tconsole.log(`压缩完成:\n\t\t\t\t\t\t原始大小: ${originalSize}KB (${imageInfo.width}x${imageInfo.height})\n\t\t\t\t\t\t压缩后大小: ${compressedSize}KB (${compressedInfo.width}x${compressedInfo.height})\n\t\t\t\t\t\t压缩率: ${((1 - finalFileInfo.size / originalFileInfo.size) * 100).toFixed(2)}%\n\t\t\t\t\t`);\n\n\t\t\t\t\treturn compressedPath.tempFilePath;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('压缩图片失败:', e);\n\t\t\t\t\treturn tempFilePath;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 生成图片文件名\n\t\t\tgetImageFileName(type = 'detail', originalExt = 'jpg') {\n\t\t\t\t// 优先使用英文名，如果没有则使用中文名\n\t\t\t\tlet switchName = this.switchData.switch_name_en || this.switchData.switch_name || 'unknown';\n\n\t\t\t\t// 移除特殊字符，只保留字母、数字、下划线\n\t\t\t\tconst safeSwitchName = switchName\n\t\t\t\t\t.replace(/\\s+/g, '_')\n\t\t\t\t\t.replace(/[^a-zA-Z0-9_]/g, '')\n\t\t\t\t\t.replace(/_+/g, '_')\n\t\t\t\t\t.replace(/^_|_$/g, '');\n\n\t\t\t\t// 生成格式化的时间字符串：YYYYMMDD_HHMMSS\n\t\t\t\tconst now = new Date();\n\t\t\t\tconst timeString = now.getFullYear() +\n\t\t\t\t\tString(now.getMonth() + 1).padStart(2, '0') +\n\t\t\t\t\tString(now.getDate()).padStart(2, '0') + '_' +\n\t\t\t\t\tString(now.getHours()).padStart(2, '0') +\n\t\t\t\t\tString(now.getMinutes()).padStart(2, '0') +\n\t\t\t\t\tString(now.getSeconds()).padStart(2, '0');\n\n\t\t\t\t// 生成随机字符串，避免文件名冲突\n\t\t\t\tconst random = Math.random().toString(36).substring(2, 8);\n\n\t\t\t\t// 如果是其他视图类型，添加序号\n\t\t\t\tlet typePrefix = '';\n\t\t\t\tif (type === 'other') {\n\t\t\t\t\t// 获取当前其他视图的数量\n\t\t\t\t\tconst otherViewCount = this.switchImages.filter(img => img.type === 'other').length;\n\t\t\t\t\t// 序号从1开始\n\t\t\t\t\ttypePrefix = `other${otherViewCount + 1}`;\n\t\t\t\t} else {\n\t\t\t\t\t// 其他类型使用原有的前缀\n\t\t\t\t\tconst prefixMap = {\n\t\t\t\t\t\tdetail: 'detail',\n\t\t\t\t\t\ttop: 'top',\n\t\t\t\t\t\tstem: 'stem',\n\t\t\t\t\t\tspring: 'spring',\n\t\t\t\t\t\tbottom: 'bottom',\n\t\t\t\t\t\tside: 'side',\n\t\t\t\t\t\thousing: 'housing'\n\t\t\t\t\t};\n\t\t\t\t\ttypePrefix = prefixMap[type] || 'other1';\n\t\t\t\t}\n\n\t\t\t\t// 构建文件名：轴体名_类型_时间_随机码.jpg\n\t\t\t\treturn `${safeSwitchName}_${typePrefix}_${timeString}_${random}.${originalExt}`;\n\t\t\t},\n\n\t\t\t// 从文件名解析图片类型\n\t\t\tgetTypeFromFileName(fileName) {\n\t\t\t\tif (!fileName) return 'detail';\n\n\t\t\t\t// 解析文件名中的类型标识\n\t\t\t\tconst typeMatches = {\n\t\t\t\t\t'detail': 'detail',\n\t\t\t\t\t'top': 'top',\n\t\t\t\t\t'stem': 'stem',\n\t\t\t\t\t'spring': 'spring',\n\t\t\t\t\t'bottom': 'bottom',\n\t\t\t\t\t'side': 'side',\n\t\t\t\t\t'housing': 'housing',\n\t\t\t\t\t'other1': 'other',\n\t\t\t\t\t'other2': 'other',\n\t\t\t\t\t'other3': 'other'\n\t\t\t\t};\n\n\t\t\t\t// 遍历所有可能的类型标识\n\t\t\t\tfor (const [typeId, type] of Object.entries(typeMatches)) {\n\t\t\t\t\tif (fileName.includes(`_${typeId}_`)) {\n\t\t\t\t\t\treturn type;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// 兼容旧的缩写格式\n\t\t\t\tconst legacyMatches = {\n\t\t\t\t\t'_dt_': 'detail',\n\t\t\t\t\t'_tp_': 'top',\n\t\t\t\t\t'_st_': 'stem',\n\t\t\t\t\t'_sp_': 'spring',\n\t\t\t\t\t'_bt_': 'bottom',\n\t\t\t\t\t'_sd_': 'side',\n\t\t\t\t\t'_hs_': 'housing',\n\t\t\t\t\t'_ot1_': 'other',\n\t\t\t\t\t'_ot2_': 'other',\n\t\t\t\t\t'_ot3_': 'other'\n\t\t\t\t};\n\n\t\t\t\t// 遍历所有旧格式的类型标识\n\t\t\t\tfor (const [typeId, type] of Object.entries(legacyMatches)) {\n\t\t\t\t\tif (fileName.includes(typeId)) {\n\t\t\t\t\t\treturn type;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// 默认返回详情图类型\n\t\t\t\treturn 'detail';\n\t\t\t},\n\n\t\t\t// 处理添加图片\n\t\t\tasync handleAddImage() {\n\t\t\t\ttry {\n\t\t\t\t\tconst res = await uni.chooseImage({\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tsizeType: ['compressed'],\n\t\t\t\t\t\tsourceType: ['album', 'camera']\n\t\t\t\t\t});\n\n\t\t\t\t\tconst tempFilePath = res.tempFilePaths[0];\n\n\t\t\t\t\t// 压缩图片\n\t\t\t\t\tconst compressedPath = await this.compressImage(tempFilePath);\n\n\t\t\t\t\t// 获取原始文件扩展名\n\t\t\t\t\tconst originalExt = 'jpg'; // 统一使用 jpg 格式\n\n\t\t\t\t\t// 使用规范的文件命名\n\t\t\t\t\tconst fileName = this.getImageFileName('detail', originalExt);\n\t\t\t\t\tconst cloudPath = fileName;\n\n\t\t\t\t\t// 上传到云存储\n\t\t\t\t\tconst uploadRes = await uniCloud.uploadFile({\n\t\t\t\t\t\tfilePath: compressedPath,\n\t\t\t\t\t\tcloudPath: cloudPath,\n\t\t\t\t\t});\n\n\t\t\t\t\tconsole.log('文件上传成功:', uploadRes);\n\n\t\t\t\t\t// 构建图片信息对象\n\t\t\t\t\tconst imageInfo = {\n\t\t\t\t\t\tfileID: uploadRes.fileID,\n\t\t\t\t\t\ttype: 'detail',\n\t\t\t\t\t\tfileName: fileName,\n\t\t\t\t\t\tuploadTime: this.getBeiJingISOString(),\n\t\t\t\t\t\tupdateTime: this.getBeiJingISOString()\n\t\t\t\t\t};\n\n\t\t\t\t\t// 更新数据库\n\t\t\t\t\tconst { result: updateResult } = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'switchApi',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'updateSwitchImage',\n\t\t\t\t\t\t\tswitchId: this.switchData._id,\n\t\t\t\t\t\t\timageIndex: this.switchImages.length,\n\t\t\t\t\t\t\timageInfo: imageInfo\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!updateResult || updateResult.errCode !== 0) {\n\t\t\t\t\t\tthrow new Error(updateResult?.errMsg || '更新失败');\n\t\t\t\t\t}\n\n\t\t\t\t\t// 更新本地数据\n\t\t\t\t\tthis.switchImages.push(imageInfo);\n\t\t\t\t\tthis.switchData.preview_images = [...this.switchImages];\n\n\t\t\t\t\t// 切换到新添加的图片\n\t\t\t\t\tthis.currentImageIndex = this.switchImages.length - 1;\n\n\t\t\t\t\t// 强制更新视图\n\t\t\t\t\tthis.$forceUpdate();\n\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '添加成功',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('添加图片失败:', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: e.message || '添加失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 删除云存储中的文件\n\t\t\tasync deleteCloudFile(fileID) {\n\t\t\t\tif (!fileID || fileID.includes('default_switch.webp')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tconst result = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'switchApi',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'deleteCloudFile',\n\t\t\t\t\t\t\tfileList: [fileID]\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (result.result.errCode === 0) {\n\t\t\t\t\t\tconsole.log('文件删除成功:', fileID, result);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(result.result.errMsg);\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('文件删除失败:', error);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 修改图片\n\t\t\tasync handleEditImage() {\n\t\t\t\tif (!this.switchImages.length) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '没有可修改的图片',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tconst now = this.getBeiJingISOString();\n\t\t\t\t\tconst res = await uni.chooseImage({\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tsizeType: ['original'],\n\t\t\t\t\t\tsourceType: ['album', 'camera']\n\t\t\t\t\t})\n\n\t\t\t\t\t// 用户取消选择图片\n\t\t\t\t\tif (!res || !res.tempFilePaths || !res.tempFilePaths.length) {\n\t\t\t\t\t\tconsole.log('用户取消选择图片');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// 保存旧图片的 fileID，用于后续删除\n\t\t\t\t\tconst oldFileID = this.switchImages[this.currentImageIndex].fileID;\n\n\t\t\t\t\tconst tempFilePath = res.tempFilePaths[0]\n\t\t\t\t\t// 压缩并转换图片\n\t\t\t\t\tconst compressedPath = await this.compressImage(tempFilePath)\n\n\t\t\t\t\t// 获取原始文件扩展名\n\t\t\t\t\tconst originalExt = 'jpg'; // 统一使用 jpg 格式\n\n\t\t\t\t\t// 使用规范的文件命名\n\t\t\t\t\tconst fileName = this.getImageFileName('detail', originalExt);\n\t\t\t\t\tconst cloudPath = fileName;\n\n\t\t\t\t\tuni.showLoading({ title: '上传中...' });\n\n\t\t\t\t\t// 上传新图片\n\t\t\t\t\tconst uploadResult = await uniCloud.uploadFile({\n\t\t\t\t\t\tfilePath: compressedPath,\n\t\t\t\t\t\tcloudPath\n\t\t\t\t\t});\n\n\t\t\t\t\t// 如果存在旧图片且不是默认图片，则删除\n\t\t\t\t\tawait this.deleteCloudFile(oldFileID);\n\n\t\t\t\t\t// 构建新的图片信息对象\n\t\t\t\t\tconst imageInfo = {\n\t\t\t\t\t\tfileID: uploadResult.fileID,\n\t\t\t\t\t\ttype: 'detail',\n\t\t\t\t\t\tfileName: fileName,\n\t\t\t\t\t\tuploadTime: this.getBeiJingISOString(),\n\t\t\t\t\t\tupdateTime: now\n\t\t\t\t\t};\n\n\t\t\t\t\t// 更新数据库\n\t\t\t\t\tconst { result: updateResult } = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'switchApi',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'updateSwitchImage',\n\t\t\t\t\t\t\tswitchId: this.switchData._id,\n\t\t\t\t\t\t\timageIndex: this.currentImageIndex,\n\t\t\t\t\t\t\timageInfo: imageInfo\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// 检查返回结果\n\t\t\t\t\tif (!updateResult || updateResult.errCode !== 0) {\n\t\t\t\t\t\tthrow new Error(updateResult?.errMsg || '更新失败');\n\t\t\t\t\t}\n\n\t\t\t\t\t// 更新本地数据\n\t\t\t\t\tthis.$set(this.switchImages, this.currentImageIndex, imageInfo);\n\t\t\t\t\tthis.switchData.preview_images = this.switchImages;\n\n\t\t\t\t\t// 刷新数据以确保同步\n\t\t\t\t\tthis.loadSwitchData(this.switchData._id);\n\n\t\t\t\t\tuni.showToast({ title: '修改成功' });\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// 处理用户取消选择图片的情况\n\t\t\t\t\tif (e.errMsg === 'chooseImage:fail cancel') {\n\t\t\t\t\t\tconsole.log('用户取消选择图片');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconsole.error('修改图片失败:', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '修改失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t} finally {\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 处理删除图片\n\t\t\tasync handleDeleteImage() {\n\t\t\t\ttry {\n\t\t\t\t\tconsole.log('开始删除图片操作');\n\t\t\t\t\t// 获取当前图片信息\n\t\t\t\t\tconst currentImage = this.switchImages[this.currentImageIndex];\n\t\t\t\t\tconsole.log('当前图片信息:', currentImage);\n\n\t\t\t\t\t// 如果是默认图片，不允许删除\n\t\t\t\t\tif (!currentImage.fileID) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '默认图片不能删除',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// 确认删除\n\t\t\t\t\tconst confirmRes = await uni.showModal({\n\t\t\t\t\t\ttitle: '确认删除',\n\t\t\t\t\t\tcontent: '确定要删除这张图片吗？',\n\t\t\t\t\t\tconfirmText: '删除',\n\t\t\t\t\t\tconfirmColor: '#f44336'\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!confirmRes.confirm) {\n\t\t\t\t\t\tconsole.log('用户取消删除');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconsole.log('准备调用云函数删除图片:', {\n\t\t\t\t\t\tswitchId: this.switchData._id,\n\t\t\t\t\t\timageIndex: this.currentImageIndex,\n\t\t\t\t\t\tfileID: currentImage.fileID\n\t\t\t\t\t});\n\n\t\t\t\t\t// 调用云函数删除图片\n\t\t\t\t\tconst { result } = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'switchApi',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'deleteSwitchImage',\n\t\t\t\t\t\t\tswitchId: this.switchData._id,\n\t\t\t\t\t\t\timageIndex: this.currentImageIndex,\n\t\t\t\t\t\t\tfileID: currentImage.fileID\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tconsole.log('云函数返回结果:', result);\n\n\t\t\t\t\t// 检查返回结果\n\t\t\t\t\tif (!result || result.errCode !== 0) {\n\t\t\t\t\t\tthrow new Error(result?.errMsg || '删除失败');\n\t\t\t\t\t}\n\n\t\t\t\t\t// 创建新的数组引用\n\t\t\t\t\tconst newImages = [...this.switchImages];\n\t\t\t\t\tnewImages.splice(this.currentImageIndex, 1);\n\n\t\t\t\t\t// 更新数据\n\t\t\t\t\tthis.switchImages = newImages;\n\t\t\t\t\tthis.switchData.preview_images = newImages;\n\n\t\t\t\t\t// 如果删除后还有图片，调整当前索引\n\t\t\t\t\tif (this.switchImages.length > 0) {\n\t\t\t\t\t\tthis.currentImageIndex = Math.min(this.currentImageIndex, this.switchImages.length - 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.currentImageIndex = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t// 关闭编辑模式\n\t\t\t\t\tthis.isEditing = false;\n\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '删除成功',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('删除图片失败:', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: e.message || '删除失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 处理图片加载错误\n\t\t\thandleImageError(index) {\n\t\t\t\tconsole.error('图片加载失败:', index, {\n\t\t\t\t\tfileID: this.switchImages[index].fileID,\n\t\t\t\t\ttype: this.switchImages[index].type\n\t\t\t\t});\n\t\t\t\t// 将错误图片替换为默认图片\n\t\t\t\tif (this.switchImages[index]) {\n\t\t\t\t\tthis.$set(this.switchImages[index], 'fileID', '/static/default_switch.webp')\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 开始编辑图片\n\t\t\tstartEditing() {\n\t\t\t\tif (!this.switchImages.length) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '暂无图片',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.isEditing = true;\n\t\t\t},\n\n\t\t\t// 确认编辑图片\n\t\t\tasync handleEditConfirm() {\n\t\t\t\ttry {\n\t\t\t\t\tconst res = await uni.chooseImage({\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tsizeType: ['original'],\n\t\t\t\t\t\tsourceType: ['album', 'camera']\n\t\t\t\t\t});\n\n\t\t\t\t\t// 用户取消选择图片\n\t\t\t\t\tif (!res || !res.tempFilePaths || !res.tempFilePaths.length) {\n\t\t\t\t\t\tconsole.log('用户取消选择图片');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst tempFilePath = res.tempFilePaths[0];\n\t\t\t\t\t// 压缩图片\n\t\t\t\t\tconst compressedPath = await this.compressImage(tempFilePath);\n\n\t\t\t\t\t// 获取原始文件扩展名\n\t\t\t\t\tconst originalExt = 'jpg'; // 统一使用 jpg 格式\n\n\t\t\t\t\t// 使用规范的文件命名\n\t\t\t\t\tconst fileName = this.getImageFileName('detail', originalExt);\n\t\t\t\t\tconst cloudPath = fileName;\n\n\t\t\t\t\tuni.showLoading({ title: '上传中...' });\n\n\t\t\t\t\t// 保存旧图片的 fileID，用于后续删除\n\t\t\t\t\tconst oldFileID = this.switchImages[this.currentImageIndex].fileID;\n\n\t\t\t\t\t// 上传新图片\n\t\t\t\t\tconst uploadResult = await uniCloud.uploadFile({\n\t\t\t\t\t\tfilePath: compressedPath,\n\t\t\t\t\t\tcloudPath\n\t\t\t\t\t});\n\n\t\t\t\t\t// 如果存在旧图片且不是默认图片，则删除\n\t\t\t\t\tawait this.deleteCloudFile(oldFileID);\n\n\t\t\t\t\t// 构建新的图片信息对象\n\t\t\t\t\tconst imageInfo = {\n\t\t\t\t\t\tfileID: uploadResult.fileID,\n\t\t\t\t\t\ttype: this.switchImages[this.currentImageIndex].type,\n\t\t\t\t\t\tfileName: fileName,\n\t\t\t\t\t\tuploadTime: this.getBeiJingISOString(),\n\t\t\t\t\t\tupdateTime: this.getBeiJingISOString()\n\t\t\t\t\t};\n\n\t\t\t\t\t// 更新数据库\n\t\t\t\t\tconst { result: updateResult } = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'switchApi',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'updateSwitchImage',\n\t\t\t\t\t\t\tswitchId: this.switchData._id,\n\t\t\t\t\t\t\timageIndex: this.currentImageIndex,\n\t\t\t\t\t\t\timageInfo: imageInfo\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// 检查返回结果\n\t\t\t\t\tif (!updateResult || updateResult.errCode !== 0) {\n\t\t\t\t\t\tthrow new Error(updateResult?.errMsg || '更新失败');\n\t\t\t\t\t}\n\n\t\t\t\t\t// 更新本地数据\n\t\t\t\t\tthis.$set(this.switchImages, this.currentImageIndex, imageInfo);\n\t\t\t\t\tthis.switchData.preview_images = [...this.switchImages];\n\n\t\t\t\t\t// 强制更新视图\n\t\t\t\t\tthis.$forceUpdate();\n\n\t\t\t\t\tuni.showToast({ title: '更换成功' });\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('编辑图片失败:', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '更换失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t} finally {\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 处理触发区域点击\n\t\t\thandleTriggerTap() {\n\t\t\t\tthis.triggerCount++;\n\t\t\t\tif (this.triggerCount >= 5) {\n\t\t\t\t\tthis.triggerCount = 0;\n\t\t\t\t\tthis.isEditing = true;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 切换到上一张图片\n\t\t\thandlePrevImage() {\n\t\t\t\tif (this.switchImages.length <= 1) return;\n\t\t\t\tthis.currentImageIndex = (this.currentImageIndex - 1 + this.switchImages.length) % this.switchImages.length;\n\t\t\t},\n\n\t\t\t// 切换到下一张图片\n\t\t\thandleNextImage() {\n\t\t\t\tif (this.switchImages.length <= 1) return;\n\t\t\t\tthis.currentImageIndex = (this.currentImageIndex + 1) % this.switchImages.length;\n\t\t\t},\n\n\t\t\t// 点击指示器切换图片\n\t\t\thandleIndicatorTap(index) {\n\t\t\t\tthis.currentImageIndex = index;\n\t\t\t},\n\n\t\t\t// 获取图片类型文本\n\t\t\tgetImageTypeText(type) {\n\t\t\t\tconst typeMap = {\n\t\t\t\t\tdetail: '详情图',\n\t\t\t\t\ttop: '上盖图',\n\t\t\t\t\tstem: '轴心图',\n\t\t\t\t\tspring: '弹簧图',\n\t\t\t\t\tbottom: '底壳图',\n\t\t\t\t\tside: '侧图',\n\t\t\t\t\thousing: '外壳图',\n\t\t\t\t\tother: '其他视图'\n\t\t\t\t};\n\t\t\t\treturn typeMap[type] || type;\n\t\t\t},\n\n\t\t\t// 修改图片类型\n\t\t\tasync handleChangeImageType() {\n\t\t\t\ttry {\n\t\t\t\t\t// 第一组选项\n\t\t\t\t\tconst imageTypes = [\n\t\t\t\t\t\t{ text: '详情图', value: 'detail' },\n\t\t\t\t\t\t{ text: '上盖图', value: 'top' },\n\t\t\t\t\t\t{ text: '轴心图', value: 'stem' },\n\t\t\t\t\t\t{ text: '弹簧图', value: 'spring' },\n\t\t\t\t\t\t{ text: '更多类型...', value: 'more' }\n\t\t\t\t\t];\n\n\t\t\t\t\tconst result = await new Promise((resolve, reject) => {\n\t\t\t\t\t\tuni.showActionSheet({\n\t\t\t\t\t\t\titemList: imageTypes.map(t => t.text),\n\t\t\t\t\t\t\titemColor: '#000000',\n\t\t\t\t\t\t\tsuccess: resolve,\n\t\t\t\t\t\t\tfail: (err) => {\n\t\t\t\t\t\t\t\tif (err.errMsg.includes('fail cancel')) {\n\t\t\t\t\t\t\t\t\tresolve({ tapIndex: -1 });\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tif (result.tapIndex === -1) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// 如果选择\"更多类型\"，显示第二组选项\n\t\t\t\t\tlet selectedType = imageTypes[result.tapIndex].value;\n\t\t\t\t\tif (selectedType === 'more') {\n\t\t\t\t\t\t// 第二组选项\n\t\t\t\t\t\tconst moreTypes = [\n\t\t\t\t\t\t\t{ text: '底壳图', value: 'bottom' },\n\t\t\t\t\t\t\t{ text: '侧图', value: 'side' },\n\t\t\t\t\t\t\t{ text: '外壳图', value: 'housing' },\n\t\t\t\t\t\t\t{ text: '其他视图', value: 'other' },\n\t\t\t\t\t\t\t{ text: '返回上级', value: 'back' }\n\t\t\t\t\t\t];\n\n\t\t\t\t\t\tconst moreResult = await new Promise((resolve, reject) => {\n\t\t\t\t\t\t\tuni.showActionSheet({\n\t\t\t\t\t\t\t\titemList: moreTypes.map(t => t.text),\n\t\t\t\t\t\t\t\titemColor: '#000000',\n\t\t\t\t\t\t\t\tsuccess: resolve,\n\t\t\t\t\t\t\t\tfail: (err) => {\n\t\t\t\t\t\t\t\t\tif (err.errMsg.includes('fail cancel')) {\n\t\t\t\t\t\t\t\t\t\tresolve({ tapIndex: -1 });\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (moreResult.tapIndex === -1 || moreTypes[moreResult.tapIndex].value === 'back') {\n\t\t\t\t\t\t\t// 如果取消或选择返回，重新调用本方法\n\t\t\t\t\t\t\tthis.handleChangeImageType();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tselectedType = moreTypes[moreResult.tapIndex].value;\n\t\t\t\t\t}\n\n\t\t\t\t\t// 检查\"其他视图\"的数量限制\n\t\t\t\t\tif (selectedType === 'other' && this.currentImage.type !== 'other') {\n\t\t\t\t\t\tconst otherViewCount = this.switchImages.filter(img => img.type === 'other').length;\n\t\t\t\t\t\tif (otherViewCount >= 3) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '其他视图最多只能有3张',\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// 获取原始文件扩展名\n\t\t\t\t\tconst originalExt = 'jpg'; // 统一使用 jpg 格式\n\n\t\t\t\t\t// 生成新的文件名\n\t\t\t\t\tconst newFileName = this.getImageFileName(selectedType, originalExt);\n\n\t\t\t\t\t// 更新图片类型\n\t\t\t\t\tconst imageInfo = {\n\t\t\t\t\t\t...this.currentImage,\n\t\t\t\t\t\ttype: selectedType,\n\t\t\t\t\t\tfileName: newFileName,\n\t\t\t\t\t\tupdateTime: this.getBeiJingISOString()\n\t\t\t\t\t};\n\n\t\t\t\t\t// 更新数据库\n\t\t\t\t\tconst { result: updateTypeResult } = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'switchApi',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'updateSwitchImage',\n\t\t\t\t\t\t\tswitchId: this.switchData._id,\n\t\t\t\t\t\t\timageIndex: this.currentImageIndex,\n\t\t\t\t\t\t\timageInfo: imageInfo\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// 检查返回结果\n\t\t\t\t\tif (!updateTypeResult || updateTypeResult.errCode !== 0) {\n\t\t\t\t\t\tthrow new Error(updateTypeResult?.errMsg || '更新失败');\n\t\t\t\t\t}\n\n\t\t\t\t\t// 更新本地数据\n\t\t\t\t\tthis.$set(this.switchImages, this.currentImageIndex, imageInfo);\n\t\t\t\t\tthis.switchData.preview_images = [...this.switchImages];\n\n\t\t\t\t\t// 强制更新视图\n\t\t\t\t\tthis.$forceUpdate();\n\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '类型修改成功',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('修改图片类型失败:', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '修改失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 获取图片类型索引\n\t\t\tgetTypeIndex(type) {\n\t\t\t\treturn this.imageTypeOptions.findIndex(option => option.value === type);\n\t\t\t},\n\n\t\t\t// 处理类型变化\n\t\t\tasync handleTypeChange(e) {\n\t\t\t\t// 如果是默认图片，不允许修改类型\n\t\t\t\tif (!this.currentImage.fileID) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '默认图片不能修改类型',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst selectedType = this.imageTypeOptions[e.detail.value].value;\n\n\t\t\t\t// 如果选择的类型与当前类型相同，不做处理\n\t\t\t\tif (selectedType === this.currentImage.type) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// 检查\"其他视图\"的数量限制\n\t\t\t\tif (selectedType === 'other' && this.currentImage.type !== 'other') {\n\t\t\t\t\tconst otherViewCount = this.switchImages.filter(img => img.type === 'other').length;\n\t\t\t\t\tif (otherViewCount >= 3) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '其他视图最多只能有3张',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\t// 获取原始文件扩展名\n\t\t\t\t\tconst originalExt = 'jpg'; // 统一使用 jpg 格式\n\n\t\t\t\t\t// 生成新的文件名\n\t\t\t\t\tconst newFileName = this.getImageFileName(selectedType, originalExt);\n\n\t\t\t\t\t// 更新图片类型\n\t\t\t\t\tconst imageInfo = {\n\t\t\t\t\t\t...this.currentImage,\n\t\t\t\t\t\ttype: selectedType,\n\t\t\t\t\t\tfileName: newFileName,\n\t\t\t\t\t\tupdateTime: this.getBeiJingISOString()\n\t\t\t\t\t};\n\n\t\t\t\t\t// 更新数据库\n\t\t\t\t\tconst { result: updateTypeResult } = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'switchApi',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'updateSwitchImage',\n\t\t\t\t\t\t\tswitchId: this.switchData._id,\n\t\t\t\t\t\t\timageIndex: this.currentImageIndex,\n\t\t\t\t\t\t\timageInfo: imageInfo\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// 检查返回结果\n\t\t\t\t\tif (!updateTypeResult || updateTypeResult.errCode !== 0) {\n\t\t\t\t\t\tthrow new Error(updateTypeResult?.errMsg || '更新失败');\n\t\t\t\t\t}\n\n\t\t\t\t\t// 更新本地数据\n\t\t\t\t\tthis.$set(this.switchImages, this.currentImageIndex, imageInfo);\n\t\t\t\t\tthis.switchData.preview_images = [...this.switchImages];\n\n\t\t\t\t\t// 强制更新视图\n\t\t\t\t\tthis.$forceUpdate();\n\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '类型修改成功',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('修改图片类型失败:', e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '修改失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 添加通过 ID 加载数据的方法\n\t\t\tasync loadSwitchDataById(id) {\n\t\t\t\ttry {\n\t\t\t\t\tconst { result } = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'switchApi',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'getSwitchById',\n\t\t\t\t\t\t\tid: id\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tif (result && result.errCode === 0 && result.data) {\n\t\t\t\t\t\tthis.handleSwitchData(result.data)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(result?.errMsg || '加载失败')\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('加载数据失败:', e)\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '加载失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\t.container {\n\t\tmin-height: 100vh;\n\t\tbackground-color: #f5f5f5;\n\t}\n\n\t.swiper {\n\t\theight: 300px;\n\t\tbackground-color: #fff;\n\n\t\t.swiper-item {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: center;\n\t\t\talign-items: center;\n\t\t\tbackground-color: #fff;\n\n\t\t\t.image-wrapper {\n\t\t\t\tposition: relative;\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: center;\n\t\t\t\talign-items: center;\n\n\t\t\t\t.image-type-tag {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\ttop: 10px;\n\t\t\t\t\tright: 10px;\n\t\t\t\t\tbackground-color: rgba(0, 0, 0, 0.6);\n\t\t\t\t\tcolor: #fff;\n\t\t\t\t\tpadding: 4px 8px;\n\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\tfont-size: 12px;\n\t\t\t\t\tz-index: 2;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tgap: 4px;\n\t\t\t\t\tcursor: pointer;\n\n\t\t\t\t\t&:active {\n\t\t\t\t\t\topacity: 0.8;\n\t\t\t\t\t}\n\n\t\t\t\t\t.edit-icon {\n\t\t\t\t\t\tfont-size: 12px;\n\t\t\t\t\t\tmargin-left: 4px;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.switch-image {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tobject-fit: contain;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t.info-list {\n\t\tmargin-top: 10px;\n\n\t\t:deep(.uni-list-item) {\n\t\t\t.uni-list-item__container {\n\t\t\t\tflex: 1;\n\t\t\t\tflex-direction: row;\n\t\t\t\tpadding: 12px 15px;\n\t\t\t}\n\n\t\t\t.uni-list-item__content {\n\t\t\t\tflex: none;\n\t\t\t\twidth: 100px;\n\t\t\t}\n\n\t\t\t.uni-list-item__content-title {\n\t\t\t\tfont-size: 14px;\n\t\t\t\tcolor: #666;\n\t\t\t\twhite-space: nowrap;\n\t\t\t}\n\n\t\t\t.uni-list-item__extra {\n\t\t\t\tflex: 1;\n\t\t\t\toverflow: visible;\n\t\t\t\talign-items: flex-end;\n\t\t\t}\n\n\t\t\t.uni-list-item__extra-text {\n\t\t\t\tfont-size: 14px;\n\t\t\t\tcolor: #333;\n\t\t\t\ttext-align: right;\n\t\t\t\twhite-space: normal;\n\t\t\t\tword-break: break-all;\n\t\t\t\tline-height: 1.4;\n\t\t\t\twidth: 100%;\n\t\t\t\tpadding-left: 15px;\n\t\t\t\tpadding-right: 15px;\n\t\t\t}\n\t\t}\n\t}\n\n\t.image-manage-trigger {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tright: 0;\n\t\twidth: 50px;\n\t\theight: 50px;\n\t\tz-index: 100;\n\n\t\t&:active {\n\t\t\tbackground-color: rgba(255, 0, 0, 0.1);\n\t\t}\n\t}\n\n\t.empty-image {\n\t\twidth: 100%;\n\t\theight: 200px;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tbackground-color: #f5f5f5;\n\t\tmargin-bottom: 15px;\n\t\tcolor: #999;\n\t}\n\n\t.edit-overlay {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground-color: rgba(0, 0, 0, 0.7);\n\t\tz-index: 1000;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\n\t\t.edit-container {\n\t\t\tbackground-color: #fff;\n\t\t\tborder-radius: 8px;\n\t\t\twidth: 90%;\n\t\t\tmax-width: 600px;\n\t\t\tpadding: 20px;\n\n\t\t\t.edit-header {\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: space-between;\n\t\t\t\talign-items: center;\n\t\t\t\tmargin-bottom: 15px;\n\n\t\t\t\t.edit-title {\n\t\t\t\t\tfont-size: 16px;\n\t\t\t\t\tfont-weight: bold;\n\t\t\t\t}\n\n\t\t\t\t.close-btn {\n\t\t\t\t\tfont-size: 24px;\n\t\t\t\t\tcolor: #999;\n\t\t\t\t\tpadding: 0 10px;\n\t\t\t\t\tcursor: pointer;\n\n\t\t\t\t\t&:active {\n\t\t\t\t\t\topacity: 0.7;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.edit-image-container {\n\t\t\t\tposition: relative;\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 200px;\n\t\t\t\tmargin-bottom: 15px;\n\t\t\t\tbackground-color: #f5f5f5;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\n\t\t\t\t.type-selector {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\ttop: 10px;\n\t\t\t\t\tright: 10px;\n\t\t\t\t\tz-index: 2;\n\n\t\t\t\t\t.picker-content {\n\t\t\t\t\t\tbackground-color: rgba(0, 0, 0, 0.6);\n\t\t\t\t\t\tcolor: #fff;\n\t\t\t\t\t\tpadding: 4px 8px;\n\t\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\t\tfont-size: 12px;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\tgap: 4px;\n\t\t\t\t\t\tmin-width: 50px;\n\t\t\t\t\t\theight: 18px;\n\t\t\t\t\t\tjustify-content: center;\n\t\t\t\t\t}\n\n\t\t\t\t\t&:active {\n\t\t\t\t\t\topacity: 0.8;\n\t\t\t\t\t}\n\n\t\t\t\t\t.picker-arrow {\n\t\t\t\t\t\tfont-size: 12px;\n\t\t\t\t\t\tmargin-left: 4px;\n\t\t\t\t\t\tcolor: #fff;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.nav-btn {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\ttop: 50%;\n\t\t\t\t\ttransform: translateY(-50%);\n\t\t\t\t\twidth: 40px;\n\t\t\t\t\theight: 40px;\n\t\t\t\t\tbackground-color: rgba(0, 0, 0, 0.5);\n\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t\tz-index: 1;\n\n\t\t\t\t\t&.prev {\n\t\t\t\t\t\tleft: 10px;\n\t\t\t\t\t}\n\n\t\t\t\t\t&.next {\n\t\t\t\t\t\tright: 10px;\n\t\t\t\t\t}\n\n\t\t\t\t\t.nav-icon {\n\t\t\t\t\t\tcolor: #fff;\n\t\t\t\t\t\tfont-size: 24px;\n\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t}\n\n\t\t\t\t\t&:active {\n\t\t\t\t\t\tbackground-color: rgba(0, 0, 0, 0.7);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.edit-image {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tobject-fit: contain;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.edit-buttons {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\tgap: 12px;\n\n\t\t\t\t.btn-row {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tgap: 10px;\n\n\t\t\t\t\t.btn {\n\t\t\t\t\t\tflex: 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.btn {\n\t\t\t\t\tmargin: 0;\n\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\theight: 40px;\n\t\t\t\t\tline-height: 40px;\n\n\t\t\t\t\t&.add {\n\t\t\t\t\t\tbackground-color: #4CAF50;\n\t\t\t\t\t}\n\n\t\t\t\t\t&.delete {\n\t\t\t\t\t\tbackground-color: #f44336;\n\t\t\t\t\t}\n\n\t\t\t\t\t&.cancel {\n\t\t\t\t\t\tbackground-color: #999;\n\t\t\t\t\t}\n\n\t\t\t\t\t&:active {\n\t\t\t\t\t\topacity: 0.8;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.image-indicators {\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: center;\n\t\t\t\tgap: 8px;\n\t\t\t\tmargin-bottom: 15px;\n\n\t\t\t\t.indicator-dot {\n\t\t\t\t\twidth: 8px;\n\t\t\t\t\theight: 8px;\n\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\tbackground-color: #ddd;\n\t\t\t\t\tcursor: pointer;\n\n\t\t\t\t\t&.active {\n\t\t\t\t\t\tbackground-color: #4CAF50;\n\t\t\t\t\t\ttransform: scale(1.2);\n\t\t\t\t\t}\n\n\t\t\t\t\t&:active {\n\t\t\t\t\t\topacity: 0.8;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</style>\n","import MiniProgramPage from 'K:/HBuilderProjects/SWITCH/pages/switchInfo/switchInfo.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","wx","uniCloud","e"],"mappings":"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"}